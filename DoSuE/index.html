<!doctype html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>DoSuE</title>
    <style>
        #map {
            width: 100%;
            height: 400px;
        }
    </style>
</head>
<body>
    <div id="map">

    </div>
    <!--
    <button id="button">押してどすえ！</button>
    <p id="result">
    </p>
-->
    <script src="http://maps.googleapis.com/maps/api/js?sensor=true&language=ja"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
        $(function(){
            // まず、ここで、地図を表示させよう

            var geocoder = new google.maps.Geocoder();
            geocoder.geocode({
                'address': '京都市中京区'
            }, function(result, status){
                if (status == google.maps.GeocoderStatus.OK) {
                    var latlng = result[0].geometry.location;
                    var options = {
                        zoom: 15,
                        center: latlng,
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                    };
                    var map = new google.maps.Map($('#map')[0], options);

                    // その地点をクリックされたら、情報領域にメッセージを表示する
                    google.maps.event.addListener(map, 'click', function(event){
                        geocoder.geocode({
                            'latLng': event.latLng
                        }, function(result, status){
                            if (status == google.maps.GeocoderStatus.OK) {
                                var infoWindow = new google.maps.InfoWindow({
                                    content: result[0].formatted_address,
                                    position: event.latLng
                                });
                                infoWindow.open(map);
                                setTimeout(function(){
                                    infoWindow.close();
                                }, 3000);
                            } else {
                                alert('エラー!');
                            }
                        });
                    })
                } else {
                    alert('エラーです');
                }
            });





                $('#button').click(function() {

                    // 緯度経度から「麩屋町 押小路 の交差点と麩屋町 御池 の交差点の間です。」など、場所を説明する文言を返します。
                    $.ajax({
                        url: "http://api.geodosu.com/v2/tellwhere?apikey='aaa'&lat=123.3&lon=223.3",
                        type: 'POST',
                        timeout: 3000
                    }).done(function(data, status, xhr){
                        $('#result').text(data);
                    }).fail(function(data, status, xhr){
                        $('#result').text(data.statusText);
                    });
                    // console.log('aaaa');
                });
        });

    </script>
</body>

</html>
